% =========================================================================
% FUNCIÓN FMATRIX
% =========================================================================
% Autor: Andrea Maybell Peña Echeverría
% Última modificación: 30/04/2019
% =========================================================================

function [d] = Fmatrix(f,r)
%FMATRIX Retorna matriz de formación deseada según la rigidez y el número
%       de grafo
% Parámetros:
%   f = número de formación / número de grafo
%   r = nivel de rigidez (de 1 a 8)
% Salidas
%   d = matriz de adyacencia de la formación

d0 = 2*sqrt(0.75);
b0 = sqrt((1.5*d0)^2 + 0.25);
b1 = sqrt(d0^2 + 4);
b2 = sqrt((0.5*d0)^2 + 2.5^2);

%% MATRICES
% matrices de adyacencia grafo mínimamente rígido
    d1 = [0 1 1 0 0 0 0 0 0 0;
          1 0 1 0 1 1 0 0 0 0;
          1 1 0 1 1 0 0 0 0 0;
          0 0 1 0 1 0 1 1 0 0;
          0 1 1 1 0 1 0 1 1 0;
          0 1 0 0 1 0 0 0 1 1;
          0 0 0 1 0 0 0 1 0 0;
          0 0 0 1 1 0 1 0 0 0;
          0 0 0 0 1 1 0 0 0 1;
          0 0 0 0 0 1 0 0 1 0];

   
    d2 = [0 1 1 0 1 0 0 0 0 0;
          1 0 0 0 1 1 0 0 0 0;
          1 0 0 1 1 0 0 0 0 0;
          0 0 1 0 1 0 1 1 0 0;
          1 1 1 1 0 1 0 1 0 0;
          0 1 0 0 1 0 0 1 0 1;
          0 0 0 1 0 0 0 1 1 0;
          0 0 0 1 1 1 1 0 1 1;
          0 0 0 0 0 0 1 1 0 1;
          0 0 0 0 0 1 0 1 1 0];
  
% matrices de adyacencia todos los nodos conectados
d2m1 = [0 1 1 1 0 0 0 0 0 0;
        1 0 1 1 1 1 1 0 0 0;
        1 1 0 0 1 0 0 0 0 0;
        1 1 0 0 0 1 0 0 0 0;
        0 1 1 0 0 0 1 0 1 0;
        0 1 0 1 0 0 1 1 0 0;
        0 1 0 0 1 1 0 1 1 1;
        0 0 0 0 0 1 1 0 0 1;
        0 0 0 0 1 0 1 0 0 1;
        0 0 0 0 0 0 1 1 1 0];
    
% matrices considerando "segundo grado de adyacencia"
    d2m2 = [0 1 1 0 1 0 0 2 0 0;
           1 0 0 2 1 1 0 0 0 2;
           1 0 0 1 1 2 2 0 0 0;
           0 2 1 0 1 0 1 1 0 2;
           1 1 1 1 0 1 0 1 2 0;
           0 1 2 0 1 0 2 1 0 1;
           0 0 2 1 0 2 0 1 1 0;
           2 0 0 1 1 1 1 0 1 1;
           0 0 0 0 2 0 1 1 0 1;
           0 2 0 2 0 1 0 1 1 0];
  
    dm1 = [0 1 1 2 0 2 0 0 0 0;
          1 0 1 0 1 1 0 2 0 2;
          1 1 0 1 1 0 2 0 2 0;
          2 0 1 0 1 2 1 1 0 0;
          0 1 1 1 0 1 0 1 1 0;
          2 1 0 2 1 0 0 0 1 1;
          0 0 2 1 0 0 0 1 0 0;
          0 2 0 1 1 0 1 0 0 0;
          0 0 2 0 1 1 0 0 0 1;
          0 2 0 0 0 1 0 0 1 0];

    dm2 = [0 1 1 2 0 2 0 0 0 0;
          1 0 1 0 1 1 0 2 0 2;
          1 1 0 1 1 0 2 0 2 0;
          2 0 1 0 1 2 1 1 0 0;
          0 1 1 1 0 1 0 1 1 0;
          2 1 0 2 1 0 0 0 1 1;
          0 0 2 1 0 0 0 1 0 0;
          0 2 0 1 1 0 1 0 1 0;
          0 0 2 0 1 1 0 1 0 1;
          0 2 0 0 0 1 0 0 1 0];
  
% matrices considerando "tercer grado de adyacencia"  
    dm3 = [0 1 1 2 0 2 3 0 0 3;
          1 0 1 0 1 1 0 2 0 2;
          1 1 0 1 1 0 2 0 2 0;
          2 0 1 0 1 2 1 1 0 0;
          0 1 1 1 0 1 0 1 1 0;
          2 1 0 2 1 0 0 0 1 1;
          3 0 2 1 0 0 0 1 2 3;
          0 2 0 1 1 0 1 0 1 2;
          0 0 2 0 1 1 2 1 0 1;
          3 2 0 0 0 1 3 2 1 0];
      
    d2m3 = [0 1 1 0 1 0 0 2 3 0;
           1 0 0 2 1 1 0 0 0 2;
           1 0 0 1 1 2 2 0 0 0;
           0 2 1 0 1 0 1 1 0 2;
           1 1 1 1 0 1 0 1 2 0;
           0 1 2 0 1 0 2 1 0 1;
           0 0 2 1 0 2 0 1 1 0;
           2 0 0 1 1 1 1 0 1 1;
           3 0 0 0 2 0 1 1 0 1;
           0 2 0 2 0 1 0 1 1 0];
 
dr1 = [0 1 1 2 d0 2 3 0 0 3;
       1 0 1 d0 1 1 0 2 d0 2;
       1 1 0 1 1 d0 2 d0 2 0;
       2 d0 1 0 1 2 1 1 d0 0;
       d0 1 1 1 0 1 d0 1 1 d0;
       2 1 d0 2 1 0 0 d0 1 1;
       3 0 2 1 d0 0 0 1 2 3;
       0 2 d0 1 1 d0 1 0 1 2;
       0 d0 2 d0 1 1 2 1 0 1;
       3 2 0 0 d0 1 3 2 1 0];
   
dr2 = [0 1 1 2 d0 2 3 b0 b0 3;
       1 0 1 d0 1 1 0 2 d0 2;
       1 1 0 1 1 d0 2 d0 2 0;
       2 d0 1 0 1 2 1 1 d0 0;
       d0 1 1 1 0 1 d0 1 1 d0;
       2 1 d0 2 1 0 0 d0 1 1;
       3 0 2 1 d0 0 0 1 2 3;
       b0 2 d0 1 1 d0 1 0 1 2;
       b0 d0 2 d0 1 1 2 1 0 1;
       3 2 0 0 d0 1 3 2 1 0];
   
dr3 = [0 1 1 2 d0 2 3 b0 b0 3;
       1 0 1 d0 1 1 b1 2 d0 2;
       1 1 0 1 1 d0 2 d0 2 b1;
       2 d0 1 0 1 2 1 1 d0 0;
       d0 1 1 1 0 1 d0 1 1 d0;
       2 1 d0 2 1 0 0 d0 1 1;
       3 b1 2 1 d0 0 0 1 2 3;
       b0 2 d0 1 1 d0 1 0 1 2;
       b0 d0 2 d0 1 1 2 1 0 1;
       3 2 b1 0 d0 1 3 2 1 0];

% Matriz completamente rígida
    dr4 = [0 1 1 2 d0 2 3 b0 b0 3;
           1 0 1 d0 1 1 b1 2 d0 2;
           1 1 0 1 1 d0 2 d0 2 b1;
           2 d0 1 0 1 2 1 1 d0 b2;
           d0 1 1 1 0 1 d0 1 1 d0;
           2 1 d0 2 1 0 b2 d0 1 1;
           3 b1 2 1 d0 b2 0 1 2 3;
           b0 2 d0 1 1 d0 1 0 1 2;
           b0 d0 2 d0 1 1 2 1 0 1;
           3 2 b1 b2 d0 1 3 2 1 0];
       
    d2r = [0 1 1 d0 1 d0 b2 2 3 b2;
           1 0 d0 2 1 1 b1 d0 b2 2;
           1 d0 0 1 1 2 2 d0 b2 b1;
           d0 2 1 0 1 d0 1 1 d0 2;
           1 1 1 1 0 1 d0 1 2 d0;
           d0 1 2 d0 1 0 2 1 d0 1;
           b2 b1 2 1 d0 2 0 1 1 d0;
           2 d0 d0 1 1 1 1 0 1 1;
           3 b2 b2 d0 2 d0 1 1 0 1;
           b2 2 b1 2 d0 1 d0 1 1 0];

% Celdas con todas las formaciones posibles
MM = {d1 dm1 dm2 dm3 dr1 dr2 dr3 dr4; 
      d2 d2m1 d2m2 d2m3 d2m3 d2m3 d2m3 d2r};

  % Matriz seleccionada
d = MM{f,r};
end

